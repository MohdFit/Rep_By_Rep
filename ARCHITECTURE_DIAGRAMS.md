# ğŸ“Š Review System - Architecture & Data Flow Diagrams

## ğŸ—ï¸ SYSTEM ARCHITECTURE

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FRONT-END (React)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  ProductMen.jsx / ProductWomen.jsx / ProductPlans.jsx       â”‚
â”‚         â”‚                                                    â”‚
â”‚         â””â”€â†’ ProductReviews Component                         â”‚
â”‚                 â”‚                                             â”‚
â”‚                 â”œâ”€â†’ Display reviews                           â”‚
â”‚                 â”œâ”€â†’ Sort & paginate                           â”‚
â”‚                 â””â”€â†’ Show ratings                              â”‚
â”‚                                                               â”‚
â”‚  MyOrders.jsx                                                â”‚
â”‚         â”‚                                                    â”‚
â”‚         â””â”€â†’ ReviewForm Component                             â”‚
â”‚                 â”‚                                             â”‚
â”‚                 â”œâ”€â†’ Star rating picker                        â”‚
â”‚                 â”œâ”€â†’ Title input (5-100 chars)                â”‚
â”‚                 â”œâ”€â†’ Comment input (10-1000 chars)            â”‚
â”‚                 â””â”€â†’ Submit review                             â”‚
â”‚                                                               â”‚
â”‚  Both components use:                                        â”‚
â”‚  â†“                                                            â”‚
â”‚  reviewService.js (API wrapper)                              â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                    axios + JWT Token
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BACK-END (Express)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  /api/reviews routes                                         â”‚
â”‚         â”‚                                                    â”‚
â”‚         â”œâ”€â†’ GET /product/:productId                          â”‚
â”‚         â”‚       â†“                                             â”‚
â”‚         â”‚   reviewController.getProductReviews()            â”‚
â”‚         â”‚       â†“                                             â”‚
â”‚         â”‚   Find approved reviews                            â”‚
â”‚         â”‚       â†“                                             â”‚
â”‚         â”‚   Return with avg rating                           â”‚
â”‚         â”‚                                                    â”‚
â”‚         â”œâ”€â†’ POST / (Create)                                  â”‚
â”‚         â”‚       â†“                                             â”‚
â”‚         â”‚   reviewController.createReview()                  â”‚
â”‚         â”‚       â†“                                             â”‚
â”‚         â”‚   Validate & check duplicates                      â”‚
â”‚         â”‚       â†“                                             â”‚
â”‚         â”‚   Create with status="pending"                     â”‚
â”‚         â”‚                                                    â”‚
â”‚         â”œâ”€â†’ PATCH /admin/:id/status                          â”‚
â”‚         â”‚       â†“                                             â”‚
â”‚         â”‚   reviewController.updateReviewStatus()            â”‚
â”‚         â”‚       â†“                                             â”‚
â”‚         â”‚   Approve/reject review                            â”‚
â”‚         â”‚                                                    â”‚
â”‚         â””â”€â†’ Other CRUD endpoints...                          â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                         MongoDB
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              DATABASE (MongoDB Collections)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  reviews collection:                                         â”‚
â”‚  {                                                           â”‚
â”‚    _id: ObjectId,                                            â”‚
â”‚    userId: ObjectId (ref: users),                            â”‚
â”‚    productId: ObjectId (ref: products),                      â”‚
â”‚    orderId: ObjectId (ref: orders),                          â”‚
â”‚    rating: 1-5,                                              â”‚
â”‚    title: "Great product!",                                  â”‚
â”‚    comment: "Long review text...",                           â”‚
â”‚    status: "pending|approved|rejected",                      â”‚
â”‚    verified: true,                                           â”‚
â”‚    helpfulCount: 5,                                          â”‚
â”‚    createdAt: timestamp,                                     â”‚
â”‚    updatedAt: timestamp                                      â”‚
â”‚  }                                                           â”‚
â”‚                                                               â”‚
â”‚  Indexes:                                                    â”‚
â”‚  - Unique compound: (userId, productId)                      â”‚
â”‚  - Sort by: createdAt, rating, helpfulCount                  â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ DATA FLOW - LEAVING A REVIEW

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User Completes Order                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User clicks "Leave a Review" in MyOrders                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ReviewForm Component renders:                                   â”‚
â”‚  - Star rating picker (click 1-5)                               â”‚
â”‚  - Title field (5-100 chars)                                    â”‚
â”‚  - Comment field (10-1000 chars)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User fills form and clicks "Submit Review"                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend Validation:                                            â”‚
â”‚  âœ“ Title is 5-100 characters                                    â”‚
â”‚  âœ“ Comment is 10-1000 characters                                â”‚
â”‚  âœ“ Rating is 1-5                                                â”‚
â”‚  âœ“ User is logged in                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  reviewService.createReview() sends POST request:               â”‚
â”‚  POST /api/reviews                                              â”‚
â”‚  {                                                              â”‚
â”‚    productId: "...",                                            â”‚
â”‚    orderId: "...",                                              â”‚
â”‚    rating: 5,                                                   â”‚
â”‚    title: "Amazing quality!",                                   â”‚
â”‚    comment: "Long detailed review..."                           â”‚
â”‚  }                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Backend Validation:                                             â”‚
â”‚  âœ“ User authenticated (JWT token)                               â”‚
â”‚  âœ“ Order exists and belongs to user                             â”‚
â”‚  âœ“ No duplicate review from user for this product              â”‚
â”‚  âœ“ Product exists                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Create Review Document:                                        â”‚
â”‚  {                                                              â”‚
â”‚    userId: <auth user>,                                         â”‚
â”‚    productId: <from request>,                                   â”‚
â”‚    orderId: <from request>,                                     â”‚
â”‚    rating: <from request>,                                      â”‚
â”‚    title: <sanitized>,                                          â”‚
â”‚    comment: <sanitized>,                                        â”‚
â”‚    status: "pending",      â† Awaiting admin approval            â”‚
â”‚    verified: true,         â† Set from order status              â”‚
â”‚    helpfulCount: 0,                                             â”‚
â”‚    createdAt: now                                               â”‚
â”‚  }                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Response sent to client:                                        â”‚
â”‚  {                                                              â”‚
â”‚    success: true,                                               â”‚
â”‚    message: "Review submitted successfully!"                    â”‚
â”‚  }                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ReviewForm shows success message:                              â”‚
â”‚  âœ“ "Review submitted successfully!"                            â”‚
â”‚  (Auto-clears after 3 seconds)                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” DATA FLOW - VIEWING REVIEWS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User visits ProductMen/Women/Plans page                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ProductReviews component mounts with productId                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  reviewService.getProductReviews(productId, params) sends:       â”‚
â”‚  GET /api/reviews/product/<productId>?                          â”‚
â”‚      page=1&limit=5&sortBy=createdAt&sortOrder=desc           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Backend processes request:                                      â”‚
â”‚  reviewController.getProductReviews()                           â”‚
â”‚  â”œâ”€ Find reviews where:                                         â”‚
â”‚  â”‚  â”œâ”€ productId matches                                        â”‚
â”‚  â”‚  â”œâ”€ status === "approved"  â† Only show approved             â”‚
â”‚  â”‚  â””â”€ verified === true      â† Only verified purchases         â”‚
â”‚  â”œâ”€ Calculate average rating from results                       â”‚
â”‚  â”œâ”€ Sort by requested field (createdAt, rating, helpful)       â”‚
â”‚  â””â”€ Paginate (5 per page)                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Response data structure:                                        â”‚
â”‚  {                                                              â”‚
â”‚    success: true,                                               â”‚
â”‚    data: [                                                      â”‚
â”‚      {                                                          â”‚
â”‚        _id: "...",                                              â”‚
â”‚        userId: { name: "John Doe", _id: "..." },               â”‚
â”‚        rating: 5,                                               â”‚
â”‚        title: "Great product!",                                 â”‚
â”‚        comment: "Detailed review...",                           â”‚
â”‚        verified: true,                                          â”‚
â”‚        helpfulCount: 12,                                        â”‚
â”‚        createdAt: "2024-01-15..."                               â”‚
â”‚      },                                                         â”‚
â”‚      ... (up to 5 per page)                                     â”‚
â”‚    ],                                                           â”‚
â”‚    statistics: {                                                â”‚
â”‚      averageRating: 4.6,                                        â”‚
â”‚      totalReviews: 42                                           â”‚
â”‚    },                                                           â”‚
â”‚    pagination: {                                                â”‚
â”‚      currentPage: 1,                                            â”‚
â”‚      pages: 9,                                                  â”‚
â”‚      total: 42                                                  â”‚
â”‚    }                                                            â”‚
â”‚  }                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ProductReviews displays:                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚  Customer Reviews                              â”‚             â”‚
â”‚  â”‚                          Average Rating: 4.6  â”‚             â”‚
â”‚  â”‚                          â˜…â˜…â˜…â˜…â˜†               â”‚             â”‚
â”‚  â”‚                          42 reviews           â”‚             â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚  â”‚  [Sort: Most Recent â–¼] [Order: Desc â–¼]        â”‚             â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚  â”‚  John Doe  â˜…â˜…â˜…â˜…â˜…  âœ“ Verified Purchase        â”‚             â”‚
â”‚  â”‚  Great Product!                                â”‚             â”‚
â”‚  â”‚  "This is a great product, very happy..."     â”‚             â”‚
â”‚  â”‚  Jan 15, 2024    ğŸ‘ 12 found helpful          â”‚             â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚  â”‚  Jane Smith  â˜…â˜…â˜…â˜…â˜†  âœ“ Verified Purchase      â”‚             â”‚
â”‚  â”‚  Good value                                    â”‚             â”‚
â”‚  â”‚  "Very good product, fits perfectly..."       â”‚             â”‚
â”‚  â”‚  Jan 14, 2024    ğŸ‘ 8 found helpful           â”‚             â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚  â”‚  ... (3 more reviews)                          â”‚             â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚  â”‚  [â† Previous] Page 1 of 9 [Next â†’]            â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ‘¨â€ğŸ’¼ ADMIN APPROVAL FLOW

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Review submitted by user                                        â”‚
â”‚  Status: "pending"                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Admin Dashboard â†’ Review Moderation                             â”‚
â”‚                                                                   â”‚
â”‚  Pending Reviews (3):                                            â”‚
â”‚  â”œâ”€ "Great Product!" - John Doe - Rating: 5 â­                  â”‚
â”‚  â”œâ”€ "Not as expected" - Jane Smith - Rating: 2 â­â­             â”‚
â”‚  â””â”€ "Excellent" - Bob Johnson - Rating: 5 â­                    â”‚
â”‚                                                                   â”‚
â”‚  Actions: [âœ“ Approve] [âœ— Reject]                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Admin clicks "Approve" button                                   â”‚
â”‚  PATCH /api/reviews/admin/<reviewId>/status                     â”‚
â”‚  { status: "approved" }                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Backend updates review:                                         â”‚
â”‚  {                                                              â”‚
â”‚    ...existing fields...,                                       â”‚
â”‚    status: "approved",    â† Changed!                            â”‚
â”‚    updatedAt: now                                               â”‚
â”‚  }                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Admin sees: "Review approved successfully!"                     â”‚
â”‚  Review removed from pending queue                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Review NOW appears in ProductReviews:                           â”‚
â”‚  (Next time component queries: status="approved" filter)        â”‚
â”‚                                                                   â”‚
â”‚  âœ“ Visible to all customers                                     â”‚
â”‚  âœ“ Affects average rating calculation                           â”‚
â”‚  âœ“ Counts toward total review count                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“± COMPONENT LIFECYCLE

```
ProductReviews Lifecycle:
â”‚
â”œâ”€ useEffect runs (on mount + productId change)
â”‚  â”‚
â”‚  â”œâ”€ Set loading = true
â”‚  â”‚
â”‚  â”œâ”€ Call getProductReviews()
â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â†’ reviewService.getProductReviews()
â”‚  â”‚      â””â”€â†’ axios GET /api/reviews/product/:id
â”‚  â”‚          â””â”€â†’ backend returns data
â”‚  â”‚
â”‚  â”œâ”€ Set loading = false
â”‚  â”œâ”€ Update state with reviews
â”‚  â””â”€ Update stats (avgRating, totalReviews)
â”‚
â”œâ”€ Render function
â”‚  â”‚
â”‚  â”œâ”€ If loading: show "Loading reviews..."
â”‚  â”œâ”€ If error: show error message
â”‚  â”œâ”€ If no reviews: show "No reviews yet"
â”‚  â””â”€ If has reviews:
â”‚      â”œâ”€ Show stats (avg rating, count)
â”‚      â”œâ”€ Show sort/filter controls
â”‚      â””â”€ Show paginated review cards
â”‚
â””â”€ User interactions
   â”‚
   â”œâ”€ Click sort/filter â†’ setPage(1), fetch new results
   â”œâ”€ Click pagination â†’ setPage(n), fetch new results
   â””â”€ Hover on reviews â†’ Show "helpful count"


ReviewForm Lifecycle:
â”‚
â”œâ”€ Component mounts
â”‚  â”‚
â”‚  â”œâ”€ Check if user logged in
â”‚  â””â”€ Initialize form state (rating: 5, title: "", comment: "")
â”‚
â”œâ”€ User fills form
â”‚  â”‚
â”‚  â”œâ”€ onChange events update state
â”‚  â”œâ”€ Star clicks set rating
â”‚  â””â”€ Input changes update title/comment
â”‚
â”œâ”€ User clicks Submit
â”‚  â”‚
â”‚  â”œâ”€ Validate input (lengths, content)
â”‚  â”œâ”€ If invalid: show error message
â”‚  â””â”€ If valid:
â”‚      â”‚
â”‚      â”œâ”€ Set loading = true
â”‚      â”œâ”€ Call createReview()
â”‚      â”‚  â”‚
â”‚      â”‚  â””â”€â†’ reviewService.createReview()
â”‚      â”‚      â””â”€â†’ axios POST /api/reviews
â”‚      â”‚          â””â”€â†’ backend creates review
â”‚      â”‚
â”‚      â”œâ”€ Set loading = false
â”‚      â”œâ”€ If success:
â”‚      â”‚  â”œâ”€ Show success message
â”‚      â”‚  â”œâ”€ Reset form
â”‚      â”‚  â”œâ”€ Call onReviewSubmitted callback
â”‚      â”‚  â””â”€ Auto-clear message after 3s
â”‚      â”‚
â”‚      â””â”€ If error:
â”‚         â””â”€ Show error message
â”‚
â””â”€ Component cleanup (unmount)
   â””â”€ Clear any timers/intervals
```

---

## ğŸ” AUTHENTICATION & AUTHORIZATION FLOW

```
Request Flow:
â”‚
â”œâ”€ Frontend sends request with JWT token
â”‚  â”‚
â”‚  â””â”€ Authorization: Bearer <jwt_token>
â”‚
â””â”€ Backend checks:
   â”‚
   â”œâ”€ Is token valid? (JWT verification)
   â”‚  â”œâ”€ No â†’ Return 401 Unauthorized
   â”‚  â””â”€ Yes â†’ Continue
   â”‚
   â”œâ”€ What action is requested?
   â”‚  â”‚
   â”‚  â”œâ”€ GET review (public)
   â”‚  â”‚  â””â”€ Allowed for everyone
   â”‚  â”‚
   â”‚  â”œâ”€ POST review (create)
   â”‚  â”‚  â”œâ”€ Allowed for authenticated users
   â”‚  â”‚  â””â”€ Must have valid order to review
   â”‚  â”‚
   â”‚  â”œâ”€ PUT/DELETE review (own)
   â”‚  â”‚  â”œâ”€ Allowed for authenticated users
   â”‚  â”‚  â””â”€ Only if review.userId === auth.userId
   â”‚  â”‚
   â”‚  â””â”€ PATCH admin endpoint
   â”‚     â”œâ”€ Allowed for admin users only
   â”‚     â””â”€ Return 403 Forbidden if not admin
   â”‚
   â””â”€ Response sent to frontend
```

---

## ğŸ“Š DATABASE SCHEMA

```
Review Document:
{
  _id: ObjectId,                 // MongoDB auto-generated
  userId: ObjectId,              // Reference to User
  productId: ObjectId,           // Reference to Product/TShirt/Plan
  orderId: ObjectId,             // Reference to Order (verification)
  rating: Number,                // 1, 2, 3, 4, or 5
  title: String,                 // 5-100 characters
  comment: String,               // 10-1000 characters
  verified: Boolean,             // true if from completed order
  status: String,                // "pending" | "approved" | "rejected"
  helpfulCount: Number,          // 0+ (votes)
  createdAt: Date,               // Auto-set on creation
  updatedAt: Date                // Auto-updated on changes
}

Indexes:
- Unique compound: { userId: 1, productId: 1 }
  â””â”€ Prevents same user reviewing same product twice

Query Patterns:
- Find by productId + status="approved" (for ProductReviews)
- Find by userId (for MyReviews)
- Find by status="pending" (for admin queue)
- Aggregate for average rating
```

---

This architecture ensures:
âœ… Clean separation of concerns (components, service, API, DB)
âœ… Proper authentication and authorization
âœ… Data consistency and validation
âœ… Scalability for many reviews
âœ… Good user experience with loading/error states
âœ… Admin moderation workflow
